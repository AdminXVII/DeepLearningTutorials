.. _fcn_1D_segm:

Network for 1D segmentation
***************************

.. note::
    This section assumes the reader has already read through :doc:`fcn_2D_segm`.


Summary
+++++++

The fundamental notions behind segmentation have been explained in :doc:`fcn_2D_segm`.
A small particularity here is that some of these notions will be applied to 1D
segmentation. Almost every Lasagne's layers used for 2D segmentation have
their respective 1D layer.




Data
++++

Let's consider a medical 1D-segmentation task. The dataset is composed of vectors of size 200
representing the cell densities and cell sizes will it goes through the cortex,
which is the outer part of the brain.

The `[BigBrain] <https://bigbrain.loris.ca/main.php>`__ dataset is composed of sections of the brain.
We were interested in the brain cortex, which is the outer part of the brain.
More precisly, we were interested in segmenting the 6 different layers of the cortex.
To do so, instead of giving as input a 2D image of one section of the brain (including the cortex),
we gave as input 1D rays going from outside the brain and through the cortex.
We call "rays" our vector of size 200 representing the cells density and size contained
on those layers. Since different layers have different cells density and size,
the profile of intensity can be used to detect boundaries.


.. figure:: images/big_brain_section.png
    :align: center
    :scale: 100%

    **Figure 1** : Big Brain section


We extract a "ray" from this Big Brain as shown in the Figure 2 :

.. figure:: images/ray.png
    :align: center
    :scale: 50%

    **Figure 2** : Ray extraction from segmentated cortex

Model
+++++

.. figure:: images/cortical_layers_net.png
    :align: center
    :scale: 100%

    **Figure 4** : Model



Results
+++++++

.. figure:: images/cortical_valid1.png
    :align: center
    :scale: 40%

    **Figure 5** : Results

View other `result <_images/cortical_valid2.png>`_

Code - Citations - Contact
++++++++++++++++++++++++++

Code
====

The FCN implementation can be found in the following file:

* `file.py <../code/file.py>`_ : Main script. Defines the model.




Papers
======

If you use this tutorial, please cite the following papers.

Fully Convolutional Networks for Semantic Segmentation

* `[pdf] <https://people.eecs.berkeley.edu/~jonlong/long_shelhamer_fcn.pdf>`__ reference

Papers related to Theano:

* `[pdf] <http://www.iro.umontreal.ca/~lisa/pointeurs/nips2012_deep_workshop_theano_final.pdf>`__ Bastien, Frédéric, Lamblin, Pascal, Pascanu, Razvan, Bergstra, James, Goodfellow, Ian, Bergeron, Arnaud, Bouchard, Nicolas, and Bengio, Yoshua. Theano: new features and speed improvements. NIPS Workshop on Deep Learning and Unsupervised Feature Learning, 2012.

* `[pdf] <http://www.iro.umontreal.ca/~lisa/pointeurs/theano_scipy2010.pdf>`__ Bergstra, James, Breuleux, Olivier, Bastien, Frédéric, Lamblin, Pascal, Pascanu, Razvan, Desjardins, Guillaume, Turian, Joseph, Warde-Farley, David, and Bengio, Yoshua. Theano: a CPU and GPU math expression compiler. In Proceedings of the Python for Scientific Computing Conference (SciPy), June 2010.

Thank you!

Contact
=======

Please email

References
++++++++++

* ref1

* ref2
